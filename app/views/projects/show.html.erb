<% content_for :head do %>
	<script type="text/javascript">
		<%= render :partial => "projects_ajax.js.erb" %>
	</script>
<% end %>


<h3 class="content-item">Project Info</h3>
<% if flash[:notice] %>
	<div class="alert alert-success"><%= flash[:notice] %></div>
<% elsif flash[:alert] %>
	<div class="alert alert-danger"><%= flash[:alert] %></div>
<% end %>
<p>
	<strong>Title:</strong>
	<%= @project.title %>
</p>
<p id="abstract">
	<strong>Abstract:</strong>
	<%= simple_format(@project.abstract) %>
</p>
<%= link_to "Edit", edit_project_path(@project), :class => "btn btn-primary" %>

<br/><br/>
<div class="panel panel-success">
	<div class="panel-heading">Supervisors</div>
	<table class="table">
		<% @supervisors.each do |supervisor| %>
		<tr>
			<td><%= link_to supervisor.title + " " + supervisor.first_name + " " + supervisor.last_name, supervisor %></td>
			<td><%= link_to "Remove", "/projects/"+@project.id.to_s+"/remove_collaborator/"+supervisor.id.to_s, 
			:method => :delete %></td>
		</tr> 
		<% end %>
	</table>
	<div class="panel-footer">
		<a id="add-supervisor">Add a Supervisor</a>
		<%= form_tag "/projects/"+@project.id.to_s+"/add_collaborator", class: "form-inline", id: "add-supervisor-form" do %>
			<div class="form-group single-field">
				<%= text_field_tag 'collaborator', nil, class: "form-control", placeholder: "Add a supervisor" %>
			</div>
			<div class="form-group"><%= submit_tag "Add", :class => "btn btn-primary btn-inline", 
				:disabled => true, :id => "add-collaborator-btn" %></div>
			<div class="form-group" id="cancel-add-supervisor"><a class="btn btn-default btn-inline">Cancel</a></div>
		<% end %>
	</div>
</div>


<h3 class="content-item">References</h3>
<div class="panel-group" id="accordion">
	<% @project_references.each do |project_reference| %>
		<%= render 'project_references/project_reference', :project_reference => project_reference %>
	<% end %>
</div>
<a id="add-reference">Add a Reference</a>


<h3 class="content-item">Files Submission</h3>
<%= form_tag({ :action => "upload"}, multipart: true) do %>
	<%= file_field_tag 'file' %>
	<%= hidden_field_tag(:user_id, current_user.id) %>
	<%= hidden_field_tag(:project_id, @project.id) %>
	<%= submit_tag ("Upload"), :class => "btn btn-primary" %>
<% end %>
<br/>
<div class="panel panel-success">
	<table class="table table-hover">
		<tr class="success">
			<th>File</th>
			<th>Uploaded at</th>
			<th></th>
		</tr>

		<% @project_files.each do |project_file| %>
		<tr>
			<td><%= project_file.original_file_name %></td>
			<td><%= project_file.created_at %></td>
			<td>
				<% if project_file.file_name.include? ".pdf" %>
					<%= link_to "View", "/web/viewer.html?file=/uploads/"+project_file.file_name %> | 
				<% end %>
				<%= link_to "Download", :action => :download, :file_name => project_file.file_name %> |
				<%= link_to "Delete", project_file, :data => { :confirm => "Are you sure?" }, :method => :delete %></td>
		</tr>  
		<% end %>
	</table>
</div>

